geom_bar(stat="identity") +
geom_text(aes(label = specify_decimal(pg,1)), position = position_stack(vjust = 0.5)) +
coord_polar(theta="y")+
labs(x="Platform", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(stat="identity") +
geom_text(aes(label = specify_decimal(pg,1)), position = position_stack(vjust = 3)) +
coord_polar(theta="y")+
labs(x="Platform", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(stat="identity") +
geom_text(aes(label = specify_decimal(pg,1)), vjust=-1) +
coord_polar(theta="y")+
labs(x="Platform", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre,label = specify_decimal(pg,1))) +
geom_bar(stat="identity") +
coord_polar(theta="y")+
labs(x="Platform", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(label = specify_decimal(pg,1)),stat="identity") +
coord_polar(theta="y")+
labs(x="Platform", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(stat="identity") +
coord_polar(theta="y")+
labs(x="Platform", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(stat="identity") +
coord_polar(theta="y")
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(stat="identity", position = position_fill()) +
geom_text(aes(label = pg), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(stat="identity", position = position_fill()) +
geom_text(aes(label = specify_decimal(pg,1)), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(stat="identity", position = position_fill()) +
geom_text(aes(x=pub, y =pg, label = specify_decimal(pg,1)), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(x=pub, y =pg, label = specify_decimal(pg,1)),stat="identity", position = position_fill()) +
geom_text(aes(x=pub, y =pg, label = specify_decimal(pg,1)), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(x=pub, y =pg),stat="identity", position = position_fill()) +
geom_text(aes(x=pub, y =pg, label = specify_decimal(pg,1)), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(x=pub, y =pg),stat="identity", position = position_fill()) +
geom_text(aes(x=pub, y =pg, label = specify_decimal(pg,1)), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")+
facet_wrap(~ City)  +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(x=pub, y =pg),stat="identity", position = position_fill()) +
geom_text(aes(x=pub, y =pg, label = specify_decimal(pg,1)), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")+
facet_wrap(~ topGenrePublisher)  +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(x=pub, y =pg),stat="identity", position = position_fill()) +
geom_text(aes(x=pub, y =pg, label = specify_decimal(pg,1)), position = position_fill(vjust = 0.5)) +
coord_polar(theta="y")+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE))
}
piecharts[[1]]
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(x=pub, y =pg),stat="identity", position = position_fill()) +
coord_polar(theta="y")+
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE))
}
piecharts[[1]]
specify_decimal <- function(x, k) trimws(format(round(x, k), nsmall=k))
piecharts <- list()
cnt <- 1
for(pub in Top8Publishers){
piecharts[[cnt]] <- ggplot(data = topGenrePublisher, aes(x=pub, y=pg, fill=Genre)) +
geom_bar(aes(x=pub, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE))
}
piecharts[[1]]
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre,color="darkred")) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre,color = "#C4961A")) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre,colour = "#C4961A")) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
cbp1 <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_color_manual(values = cbp1)
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_fill_manual(values = c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7"))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_fill_manual(values = c("#999999", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7"))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_color_brewer(palette = "Paired")
library(RColorBrewer)
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_color_brewer(palette = "Paired")
install.packages("RColorBrewer")
install.packages("RColorBrewer")
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_fill_manual(values = c("#c60101", "#630101", "#e38080", "#f4cccc",
"#0109fe", "#010598", "#000466", "#676bfe",
"#999dff", "#e6e6ff", "#D55E00", "#CC79A7"))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_fill_manual(values = c("#c60101", "#630101", "#e38080", "#f4cccc",
"#0109fe", "#010598", "#000466", "#676bfe",
"#999dff", "#e6e6ff", "#000000", "#FFFFFF"))
library(ggplot2)
library(plyr)
library(ggpubr)
library(tidyverse)
vgsales <- vgsales[which(vgsales$Year < 2016),]
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top8Publishers <- c(salesPerPublisher[1:8,1])
topGenrePublisher <- ddply(vgsales,c("Genre","Publisher"),summarize,
sales = sum(vgsales[which(vgsales$Genre == Genre & vgsales$Publisher == Publisher),11]))
venteParPublisher <- ddply(vgsales,"Publisher",summarize,
VT = sum(vgsales[which(vgsales$Publisher == Publisher),11]))
topGenrePublisher <- topGenrePublisher[which(topGenrePublisher$Publisher %in% Top8Publishers),]
topGenrePublisher <- merge(topGenrePublisher,venteParPublisher)
topGenrePublisher$pg <- (topGenrePublisher$sales/topGenrePublisher$VT)*100
specify_decimal <- function(x, k) trimws(format(round(x, k), nsmall=k))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_fill_manual(values = c("#c60101", "#630101", "#e38080", "#f4cccc",
"#0109fe", "#010598", "#000466", "#676bfe",
"#999dff", "#e6e6ff", "#000000", "#FFFFFF"))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
ggplot(data = topGenrePublisher, aes(x=Publisher, y=pg, fill=Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_fill_manual(values = c("#06AED5", "#086788", "#F0C808", "#FFF1D0",
"#DD1C1A", "#4E0250", "#801A86", "#58BC82",
"#ED6A5A", "#D72638", "#FFFFFF", "#000000"))
ggplot(data = topGenrePublisher, aes( x = Publisher, y = pg, fill = Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
ggplot(data = topGenrePublisher, aes( x = Publisher, y = pg, fill = Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_color_gradientn(colours = rainbow(12))
ggplot(data = topGenrePublisher, aes( x = Publisher, y = pg, fill = Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_color_gradient2()
ggplot(data = topGenrePublisher, aes( x = Publisher, y = pg, fill = Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_color_gradient2()
ggplot(data = topGenrePublisher, aes( x = Publisher, y = pg, fill = Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
scale_color_gradient()
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top8Publishers <- c(salesPerPublisher[1:8,1])
topGenrePublisher <- ddply(vgsales,c("Genre","Publisher"),summarize,
sales = sum(vgsales[which(vgsales$Genre == Genre & vgsales$Publisher == Publisher),11]))
venteParPublisher <- ddply(vgsales,"Publisher",summarize,
VT = sum(vgsales[which(vgsales$Publisher == Publisher),11]))
topGenrePublisher <- topGenrePublisher[which(topGenrePublisher$Publisher %in% Top8Publishers),]
topGenrePublisher <- merge(topGenrePublisher,venteParPublisher)
topGenrePublisher$pg <- (topGenrePublisher$sales/topGenrePublisher$VT)*100
specify_decimal <- function(x, k) trimws(format(round(x, k), nsmall=k))
ggplot(data = topGenrePublisher, aes( x = Publisher, y = pg, fill = Genre)) +
geom_bar(aes(x=Publisher, y =pg),stat="identity", position = position_fill()) +
theme(axis.title.x = element_blank(),
axis.title.y = element_blank()) +
theme(legend.position='bottom') +
guides(fill=guide_legend(nrow=2, byrow=TRUE)) +
labs(x="Publisher", y="Share of sales for each genre", title="Share of sales for each genre per publisher") +
scale_x_discrete(guide = guide_axis(n.dodge = 3))
salesYearPlatform <- ddply(vgsales,c("Platform","Year"),summarize,
sales=sum(Global_Sales))
ggplot(salesYearPlatform, aes(x=Year, y = sales, group = Platform, colour = Platform)) +
geom_line(size=1) +
labs(x = "Year", y = "Sales (in millions)", title = "Sales per platform, per year") +
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top20Publishers <- c(salesPerPublisher[1:20,1])
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top20Publishers <- c(salesPerPublisher[1:20,1])
salesPerPublisher <- salesPerPublisher[which(salesPerPublisher$Publisher %in% Top20Publishers),]
View(salesPerPublisher)
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top20Publishers <- c(salesPerPublisher[1:20,1])
salesPerPublisher <- salesPerPublisher[which(salesPerPublisher$Publisher %in% Top20Publishers),]
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(n.dodge = 2))
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top20Publishers <- c(salesPerPublisher[1:20,1])
salesPerPublisher <- salesPerPublisher[which(salesPerPublisher$Publisher %in% Top20Publishers),]
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Share of sales for the top-selling genre", title="Share of sales for the top-selling genre per platform") +
scale_x_discrete(guide = guide_axis(4))
View(vgsales)
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top20Publishers <- c(salesPerPublisher[1:20,1])
salesPerPublisher <- salesPerPublisher[which(salesPerPublisher$Publisher %in% Top20Publishers),]
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015") +
scale_x_discrete(guide = guide_axis(n.dodge = 4))
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015") +
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015")
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015") +
scale_fill_discrete(guide=FALSE)
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015") +
guides(x=FALSE)
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015") +
guides(fill=FALSE)
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = sales),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
salesPerPublisher <- ddply(vgsales,"Publisher",summarize,
sales=sum(Global_Sales))
salesPerPublisher <- salesPerPublisher[order(-salesPerPublisher$sales),]
Top20Publishers <- c(salesPerPublisher[1:20,1])
salesPerPublisher <- salesPerPublisher[which(salesPerPublisher$Publisher %in% Top20Publishers),]
ggplot(data = salesPerPublisher) +
geom_bar(aes(x = Publisher, y = sales, fill = Publisher),alpha=0.5,stat="identity") +
geom_text(aes(x = Publisher, y = sales,label = specify_decimal(sales,0)),size=3,vjust=-1) +
labs(x="Publisher", y="Sales (in millions)", title="Sales per publisher, between 1980 and 2015") +
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
salesYearPlatform <- ddply(vgsales,c("Platform","Year"),summarize,
sales=sum(Global_Sales))
ggplot(salesYearPlatform, aes(x=Year, y = sales, group = Platform, colour = Platform)) +
geom_line(size=1) +
labs(x = "Year", y = "Sales (in millions)", title = "Sales per platform, per year") +
scale_x_discrete(guide = guide_axis(check.overlap = TRUE))
